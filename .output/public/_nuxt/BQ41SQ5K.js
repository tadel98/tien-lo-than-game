import{_ as j}from"./Bm7vLDfF.js";import{z as I,r as Q,g as p,j as O,c as l,b as J,a as e,t as a,F as g,m as y,l as m,o,p as M}from"#entry";import{u as R}from"./CWJf_NK_.js";import{u as A}from"./C9N9uCYs.js";const D=I("quest",()=>{const u=Q([]),i=Q(!1),v=Q(null),k=p(()=>u.value.filter(n=>n.playerStatus.status==="available")),h=p(()=>u.value.filter(n=>n.playerStatus.status==="in_progress")),V=p(()=>u.value.filter(n=>n.playerStatus.status==="completed")),S=p(()=>{const n={};return u.value.forEach(r=>{n[r.level]||(n[r.level]=[]),n[r.level].push(r)}),n});return{quests:u,loading:i,error:v,availableQuests:k,inProgressQuests:h,completedQuests:V,questsByLevel:S,fetchQuests:async n=>{try{i.value=!0,v.value=null;const r=await $fetch(`/api/quest/list?playerId=${n}`);u.value=r.data.quests}catch(r){v.value=r.message,console.error("Error fetching quests:",r)}finally{i.value=!1}},startQuest:async(n,r)=>{try{i.value=!0,v.value=null;const c=await $fetch("/api/quest/start",{method:"POST",body:{playerId:n,questId:r}}),f=u.value.findIndex(N=>N.id===r);return f!==-1&&(u.value[f]=c.data.quest),c.data}catch(c){throw v.value=c.message,console.error("Error starting quest:",c),c}finally{i.value=!1}},completeQuest:async(n,r)=>{try{i.value=!0,v.value=null;const c=await $fetch("/api/quest/complete",{method:"POST",body:{playerId:n,questId:r}}),f=u.value.findIndex(N=>N.id===r);return f!==-1&&(u.value[f]=c.data.quest),c.data}catch(c){throw v.value=c.message,console.error("Error completing quest:",c),c}finally{i.value=!1}},getQuestById:n=>u.value.find(r=>r.id===n),getQuestsByLevel:n=>u.value.filter(r=>r.level===n),reset:()=>{u.value=[],i.value=!1,v.value=null}}}),X={key:0,class:"min-h-screen"},z={key:1,class:"min-h-screen text-white"},F={class:"bg-black/20 backdrop-blur-sm border-b border-purple-500/30"},K={class:"container mx-auto px-4 py-6"},U={class:"flex items-center justify-between"},G=["disabled"],W={class:"container mx-auto px-4 py-6"},Y={class:"flex space-x-2 mb-8"},Z=["onClick"],q={class:"grid gap-6"},ee={key:0,class:"space-y-4"},te={class:"flex items-start justify-between"},se={class:"flex-1"},le={class:"flex items-center space-x-3 mb-3"},ae={class:"text-lg font-bold text-white"},oe={class:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full"},ne={key:0,class:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full"},re={class:"text-gray-300 mb-4"},ie={class:"mb-4"},de={class:"flex flex-wrap gap-2"},ce={key:0,class:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm"},ue=["onClick","disabled"],he={key:1,class:"space-y-4"},pe={class:"flex items-start justify-between"},ve={class:"flex-1"},me={class:"flex items-center space-x-3 mb-3"},be={class:"text-lg font-bold text-white"},xe={class:"text-gray-300 mb-4"},ge={class:"mb-4"},ye={class:"flex flex-wrap gap-2"},fe={key:0,class:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm"},_e=["onClick","disabled"],we={key:2,class:"space-y-4"},ke={class:"flex items-start justify-between"},Ne={class:"flex-1"},Qe={class:"flex items-center space-x-3 mb-3"},Se={class:"text-lg font-bold text-white"},Ce={class:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full"},Le={class:"text-gray-300 mb-4"},Te={class:"mb-4"},Pe={class:"flex flex-wrap gap-2"},$e={key:0,class:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm"},Ve=["onClick","disabled"],He={key:3,class:"space-y-4"},Be={class:"flex items-start justify-between"},Ee={class:"flex-1"},je={class:"flex items-center space-x-3 mb-3"},Ie={class:"text-lg font-bold text-white"},Oe={class:"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs rounded-full"},Je={class:"text-gray-300 mb-4"},Me={class:"mb-4"},Re={class:"text-sm text-gray-400"},Ae={class:"text-sm text-orange-400"},De={key:4,class:"space-y-4"},Xe={class:"flex items-start justify-between"},ze={class:"flex-1"},Fe={class:"flex items-center space-x-3 mb-3"},Ke={class:"text-lg font-bold text-white"},Ue={class:"text-gray-300 mb-4"},Ge={class:"text-sm text-gray-400"},We={key:5,class:"text-center py-12"},Ye={class:"text-xl text-gray-400 mb-2"},Ze={class:"text-sm text-gray-500"},qe={key:6,class:"text-center py-12"},at={__name:"quest",setup(u){const i=D(),v=R(),k=A(),h=Q("available"),V=Q([{value:"available",label:"C√≥ Th·ªÉ Nh·∫≠n",icon:"üìã"},{value:"in_progress",label:"ƒêang Th·ª±c Hi·ªán",icon:"‚è≥"},{value:"completed",label:"ƒê√£ Ho√†n Th√†nh",icon:"‚úÖ"},{value:"repeatable",label:"L·∫∑p L·∫°i",icon:"üîÑ"},{value:"cooldown",label:"Ch·ªù L√†m M·ªõi",icon:"‚è∞"}]),S=p(()=>v.isLoggedIn),b=p(()=>k.player),w=p(()=>i.loading),C=p(()=>i.availableQuests),L=p(()=>i.inProgressQuests),T=p(()=>i.completedQuests),P=p(()=>i.quests.filter(d=>d.isRepeatable&&d.playerStatus.status==="available")),n=p(()=>i.quests.filter(d=>d.playerStatus.status==="cooldown")),r=p(()=>{switch(h.value){case"available":return C.value;case"in_progress":return L.value;case"completed":return T.value;case"repeatable":return P.value;case"cooldown":return n.value;default:return[]}}),c=async()=>{b.value?.id&&await i.fetchQuests(b.value.id)},f=async d=>{try{const s=await i.startQuest(b.value.id,d);console.log("Nhi·ªám v·ª• ƒë√£ ƒë∆∞·ª£c nh·∫≠n:",s.quest.displayName),await k.fetchResources(b.value.id)}catch(s){console.error("L·ªói nh·∫≠n nhi·ªám v·ª•:",s)}},N=async d=>{try{const s=await i.completeQuest(b.value.id,d);console.log("Nhi·ªám v·ª• ƒë√£ ho√†n th√†nh:",s.quest.displayName),console.log("Ph·∫ßn th∆∞·ªüng:",s.rewards),s.levelUp&&console.log(`üéâ Level Up! Level ${s.newLevel}`),await k.fetchResources(b.value.id)}catch(s){console.error("L·ªói ho√†n th√†nh nhi·ªám v·ª•:",s)}},H=d=>d?new Date(d).toLocaleString("vi-VN"):"Ch∆∞a x√°c ƒë·ªãnh",B=d=>({easy:"D·ªÖ",medium:"Trung B√¨nh",hard:"Kh√≥",expert:"Chuy√™n Gia"})[d]||d,E=d=>{if(!d)return"0s";const s=Math.floor(d/60),$=d%60;return s>0?`${s}m ${$}s`:`${$}s`};return O(async()=>{v.initializeAuth(),S.value&&b.value?.id&&await i.fetchQuests(b.value.id)}),(d,s)=>{const $=j;return S.value?(o(),l("div",z,[e("div",F,[e("div",K,[e("div",U,[s[0]||(s[0]=e("div",{class:"flex items-center space-x-4"},[e("h1",{class:"text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent"}," üìã Nhi·ªám V·ª• "),e("div",{class:"text-sm text-gray-400"}," Ho√†n th√†nh nhi·ªám v·ª• ƒë·ªÉ nh·∫≠n EXP v√† t√†i nguy√™n ")],-1)),e("button",{onClick:c,disabled:w.value,class:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 rounded-lg transition-colors"},a(w.value?"ƒêang t·∫£i...":"üîÑ L√†m m·ªõi"),9,G)])])]),e("div",W,[e("div",Y,[(o(!0),l(g,null,y(V.value,t=>(o(),l("button",{key:t.value,onClick:x=>h.value=t.value,class:M(["px-6 py-3 rounded-lg font-medium transition-all duration-300",h.value===t.value?"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50"])},a(t.icon)+" "+a(t.label),11,Z))),128))]),e("div",q,[h.value==="available"&&C.value.length>0?(o(),l("div",ee,[s[2]||(s[2]=e("h2",{class:"text-xl font-bold text-white mb-4"},"Nhi·ªám V·ª• C√≥ Th·ªÉ Nh·∫≠n",-1)),(o(!0),l(g,null,y(C.value,t=>(o(),l("div",{key:t.id,class:"bg-gray-900/50 backdrop-blur-sm rounded-xl border border-purple-500/20 p-6 hover:border-purple-500/40 transition-all duration-300"},[e("div",te,[e("div",se,[e("div",le,[e("h3",ae,a(t.displayName),1),e("span",oe,a(B(t.difficulty)),1),t.isRepeatable?(o(),l("span",ne," üîÑ "+a(t.repeatInterval)+"p ",1)):m("",!0)]),e("p",re,a(t.description),1),e("div",ie,[s[1]||(s[1]=e("h4",{class:"text-sm font-semibold text-yellow-400 mb-2"},"Ph·∫ßn Th∆∞·ªüng:",-1)),e("div",de,[t.rewards?(o(),l("span",ce," +"+a(JSON.parse(t.rewards).experience||0)+" EXP ",1)):m("",!0),(o(!0),l(g,null,y(JSON.parse(t.rewards||"{}").resources||{},(x,_)=>(o(),l("span",{key:_,class:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm"}," +"+a(x)+" "+a(_),1))),128))])])]),e("button",{onClick:x=>f(t.id),disabled:w.value||b.value?.level<t.level,class:"ml-4 px-6 py-2 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white font-semibold transition-all duration-300"}," Nh·∫≠n Nhi·ªám V·ª• ",8,ue)])]))),128))])):m("",!0),h.value==="in_progress"&&L.value.length>0?(o(),l("div",he,[s[6]||(s[6]=e("h2",{class:"text-xl font-bold text-white mb-4"},"Nhi·ªám V·ª• ƒêang Th·ª±c Hi·ªán",-1)),(o(!0),l(g,null,y(L.value,t=>(o(),l("div",{key:t.id,class:"bg-gray-900/50 backdrop-blur-sm rounded-xl border border-orange-500/20 p-6 hover:border-orange-500/40 transition-all duration-300"},[e("div",pe,[e("div",ve,[e("div",me,[e("h3",be,a(t.displayName),1),s[3]||(s[3]=e("span",{class:"px-2 py-1 bg-orange-500/20 text-orange-400 text-xs rounded-full"}," ƒêang th·ª±c hi·ªán ",-1))]),e("p",xe,a(t.description),1),s[5]||(s[5]=e("div",{class:"mb-4"},[e("div",{class:"flex items-center justify-between text-sm text-gray-400 mb-2"},[e("span",null,"Ti·∫øn ƒë·ªô"),e("span",null,"100%")]),e("div",{class:"w-full bg-gray-700 rounded-full h-2"},[e("div",{class:"bg-gradient-to-r from-orange-500 to-yellow-500 h-2 rounded-full",style:{width:"100%"}})])],-1)),e("div",ge,[s[4]||(s[4]=e("h4",{class:"text-sm font-semibold text-yellow-400 mb-2"},"Ph·∫ßn Th∆∞·ªüng:",-1)),e("div",ye,[t.rewards?(o(),l("span",fe," +"+a(JSON.parse(t.rewards).experience||0)+" EXP ",1)):m("",!0),(o(!0),l(g,null,y(JSON.parse(t.rewards||"{}").resources||{},(x,_)=>(o(),l("span",{key:_,class:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm"}," +"+a(x)+" "+a(_),1))),128))])])]),e("button",{onClick:x=>N(t.id),disabled:w.value,class:"ml-4 px-6 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white font-semibold transition-all duration-300"}," Ho√†n Th√†nh ",8,_e)])]))),128))])):m("",!0),h.value==="repeatable"&&P.value.length>0?(o(),l("div",we,[s[8]||(s[8]=e("h2",{class:"text-xl font-bold text-white mb-4"},"Nhi·ªám V·ª• L·∫∑p L·∫°i",-1)),(o(!0),l(g,null,y(P.value,t=>(o(),l("div",{key:t.id,class:"bg-gray-900/50 backdrop-blur-sm rounded-xl border border-green-500/20 p-6 hover:border-green-500/40 transition-all duration-300"},[e("div",ke,[e("div",Ne,[e("div",Qe,[e("h3",Se,a(t.displayName),1),e("span",Ce," üîÑ "+a(t.repeatInterval)+"p ",1)]),e("p",Le,a(t.description),1),e("div",Te,[s[7]||(s[7]=e("h4",{class:"text-sm font-semibold text-yellow-400 mb-2"},"Ph·∫ßn Th∆∞·ªüng:",-1)),e("div",Pe,[t.rewards?(o(),l("span",$e," +"+a(JSON.parse(t.rewards).experience||0)+" EXP ",1)):m("",!0),(o(!0),l(g,null,y(JSON.parse(t.rewards||"{}").resources||{},(x,_)=>(o(),l("span",{key:_,class:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm"}," +"+a(x)+" "+a(_),1))),128))])])]),e("button",{onClick:x=>f(t.id),disabled:w.value,class:"ml-4 px-6 py-2 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white font-semibold transition-all duration-300"}," Nh·∫≠n Nhi·ªám V·ª• ",8,Ve)])]))),128))])):m("",!0),h.value==="cooldown"&&n.value.length>0?(o(),l("div",He,[s[9]||(s[9]=e("h2",{class:"text-xl font-bold text-white mb-4"},"Nhi·ªám V·ª• ƒêang Ch·ªù L√†m M·ªõi",-1)),(o(!0),l(g,null,y(n.value,t=>(o(),l("div",{key:t.id,class:"bg-gray-900/50 backdrop-blur-sm rounded-xl border border-orange-500/20 p-6 hover:border-orange-500/40 transition-all duration-300"},[e("div",Be,[e("div",Ee,[e("div",je,[e("h3",Ie,a(t.displayName),1),e("span",Oe," ‚è∞ "+a(t.playerStatus.cooldownRemaining)+"s ",1)]),e("p",Je,a(t.description),1),e("div",Me,[e("div",Re," Ho√†n th√†nh l·∫ßn cu·ªëi: "+a(H(t.playerStatus.lastCompletedAt)),1),e("div",Ae," C√≥ th·ªÉ nh·∫≠n l·∫°i sau: "+a(E(t.playerStatus.cooldownRemaining)),1)])])])]))),128))])):m("",!0),h.value==="completed"&&T.value.length>0?(o(),l("div",De,[s[11]||(s[11]=e("h2",{class:"text-xl font-bold text-white mb-4"},"Nhi·ªám V·ª• ƒê√£ Ho√†n Th√†nh",-1)),(o(!0),l(g,null,y(T.value,t=>(o(),l("div",{key:t.id,class:"bg-gray-900/50 backdrop-blur-sm rounded-xl border border-green-500/20 p-6 hover:border-green-500/40 transition-all duration-300"},[e("div",Xe,[e("div",ze,[e("div",Fe,[e("h3",Ke,a(t.displayName),1),s[10]||(s[10]=e("span",{class:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full"}," ƒê√£ ho√†n th√†nh ",-1))]),e("p",Ue,a(t.description),1),e("div",Ge," Ho√†n th√†nh: "+a(H(t.playerStatus.completedAt)),1)])])]))),128))])):m("",!0),r.value.length===0?(o(),l("div",We,[s[12]||(s[12]=e("div",{class:"text-6xl mb-4"},"üìã",-1)),e("div",Ye,a(h.value==="available"?"Kh√¥ng c√≥ nhi·ªám v·ª• n√†o":h.value==="in_progress"?"Kh√¥ng c√≥ nhi·ªám v·ª• ƒëang th·ª±c hi·ªán":"Ch∆∞a ho√†n th√†nh nhi·ªám v·ª• n√†o"),1),e("div",Ze,a(h.value==="available"?"H√£y n√¢ng c·∫•p level ƒë·ªÉ m·ªü kh√≥a nhi·ªám v·ª• m·ªõi":h.value==="in_progress"?"H√£y nh·∫≠n nhi·ªám v·ª• ƒë·ªÉ b·∫Øt ƒë·∫ßu":"H√£y ho√†n th√†nh nhi·ªám v·ª• ƒë·ªÉ xem l·ªãch s·ª≠"),1)])):m("",!0),w.value?(o(),l("div",qe,[...s[13]||(s[13]=[e("div",{class:"animate-spin w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("div",{class:"text-gray-400"},"ƒêang t·∫£i nhi·ªám v·ª•...",-1)])])):m("",!0)])])])):(o(),l("div",X,[J($)]))}}};export{at as default};
