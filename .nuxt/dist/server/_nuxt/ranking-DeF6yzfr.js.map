{"version":3,"file":"ranking-DeF6yzfr.js","sources":["../../../../stores/ranking.ts"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\n\r\nexport const useRankingStore = defineStore('ranking', () => {\r\n  // State\r\n  const ranking = ref<any[]>([])\r\n  const loading = ref(false)\r\n  const error = ref(null)\r\n  const currentType = ref('level') // level, combat_power, experience\r\n  const lastUpdated = ref(null)\r\n\r\n  // Getters\r\n  const topPlayers = computed(() => ranking.value)\r\n  \r\n  const topByLevel = computed(() => {\r\n    return ranking.value.filter((_, index) => index < 10)\r\n  })\r\n  \r\n  const topByCombatPower = computed(() => {\r\n    return [...ranking.value].sort((a, b) => b.combatPower - a.combatPower).slice(0, 10)\r\n  })\r\n  \r\n  const topByExperience = computed(() => {\r\n    return [...ranking.value].sort((a, b) => b.experience - a.experience).slice(0, 10)\r\n  })\r\n\r\n  const playerRank = computed(() => {\r\n    return (playerId: string) => {\r\n      return ranking.value.findIndex(player => player.id === playerId) + 1\r\n    }\r\n  })\r\n\r\n  // Actions\r\n  const fetchRanking = async (type: string = 'level', limit: number = 20) => {\r\n    try {\r\n      loading.value = true\r\n      error.value = null\r\n\r\n      const response: any = await $fetch(`/api/ranking/top-players?type=${type}&limit=${limit}`)\r\n      ranking.value = response.data.ranking\r\n      currentType.value = response.data.type\r\n      lastUpdated.value = response.data.lastUpdated\r\n    } catch (err: any) {\r\n      error.value = err.message\r\n      console.error('Error fetching ranking:', err)\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n\r\n  const refreshRanking = async () => {\r\n    await fetchRanking(currentType.value)\r\n  }\r\n\r\n  const getPlayerStats = (playerId: string) => {\r\n    return ranking.value.find(player => player.id === playerId)\r\n  }\r\n\r\n  const getTopPlayersByType = (type: string, limit: number = 10) => {\r\n    switch (type) {\r\n      case 'combat_power':\r\n        return topByCombatPower.value.slice(0, limit)\r\n      case 'experience':\r\n        return topByExperience.value.slice(0, limit)\r\n      case 'level':\r\n      default:\r\n        return topByLevel.value.slice(0, limit)\r\n    }\r\n  }\r\n\r\n  const reset = () => {\r\n    ranking.value = []\r\n    loading.value = false\r\n    error.value = null\r\n    currentType.value = 'level'\r\n    lastUpdated.value = null\r\n  }\r\n\r\n  return {\r\n    // State\r\n    ranking,\r\n    loading,\r\n    error,\r\n    currentType,\r\n    lastUpdated,\r\n    \r\n    // Getters\r\n    topPlayers,\r\n    topByLevel,\r\n    topByCombatPower,\r\n    topByExperience,\r\n    playerRank,\r\n    \r\n    // Actions\r\n    fetchRanking,\r\n    refreshRanking,\r\n    getPlayerStats,\r\n    getTopPlayersByType,\r\n    reset\r\n  }\r\n})\r\n"],"names":[],"mappings":";;AAGO,MAAM,kBAAkB,YAAY,WAAW,MAAM;AAE1D,QAAM,UAAU,IAAW,EAAE;AAC7B,QAAM,UAAU,IAAI,KAAK;AACzB,QAAM,QAAQ,IAAI,IAAI;AACtB,QAAM,cAAc,IAAI,OAAO;AAC/B,QAAM,cAAc,IAAI,IAAI;AAG5B,QAAM,aAAa,SAAS,MAAM,QAAQ,KAAK;AAE/C,QAAM,aAAa,SAAS,MAAM;AAChC,WAAO,QAAQ,MAAM,OAAO,CAAC,GAAG,UAAU,QAAQ,EAAE;AAAA,EACtD,CAAC;AAED,QAAM,mBAAmB,SAAS,MAAM;AACtC,WAAO,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,cAAc,EAAE,WAAW,EAAE,MAAM,GAAG,EAAE;AAAA,EACrF,CAAC;AAED,QAAM,kBAAkB,SAAS,MAAM;AACrC,WAAO,CAAC,GAAG,QAAQ,KAAK,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,aAAa,EAAE,UAAU,EAAE,MAAM,GAAG,EAAE;AAAA,EACnF,CAAC;AAED,QAAM,aAAa,SAAS,MAAM;AAChC,WAAO,CAAC,aAAqB;AAC3B,aAAO,QAAQ,MAAM,UAAU,YAAU,OAAO,OAAO,QAAQ,IAAI;AAAA,IACrE;AAAA,EACF,CAAC;AAGD,QAAM,eAAe,OAAO,OAAe,SAAS,QAAgB,OAAO;AACzE,QAAI;AACF,cAAQ,QAAQ;AAChB,YAAM,QAAQ;AAEd,YAAM,WAAgB,MAAM,OAAO,iCAAiC,IAAI,UAAU,KAAK,EAAE;AACzF,cAAQ,QAAQ,SAAS,KAAK;AAC9B,kBAAY,QAAQ,SAAS,KAAK;AAClC,kBAAY,QAAQ,SAAS,KAAK;AAAA,IACpC,SAAS,KAAU;AACjB,YAAM,QAAQ,IAAI;AAClB,cAAQ,MAAM,2BAA2B,GAAG;AAAA,IAC9C,UAAA;AACE,cAAQ,QAAQ;AAAA,IAClB;AAAA,EACF;AAEA,QAAM,iBAAiB,YAAY;AACjC,UAAM,aAAa,YAAY,KAAK;AAAA,EACtC;AAEA,QAAM,iBAAiB,CAAC,aAAqB;AAC3C,WAAO,QAAQ,MAAM,KAAK,CAAA,WAAU,OAAO,OAAO,QAAQ;AAAA,EAC5D;AAEA,QAAM,sBAAsB,CAAC,MAAc,QAAgB,OAAO;AAChE,YAAQ,MAAA;AAAA,MACN,KAAK;AACH,eAAO,iBAAiB,MAAM,MAAM,GAAG,KAAK;AAAA,MAC9C,KAAK;AACH,eAAO,gBAAgB,MAAM,MAAM,GAAG,KAAK;AAAA,MAC7C,KAAK;AAAA,MACL;AACE,eAAO,WAAW,MAAM,MAAM,GAAG,KAAK;AAAA,IAAA;AAAA,EAE5C;AAEA,QAAM,QAAQ,MAAM;AAClB,YAAQ,QAAQ,CAAA;AAChB,YAAQ,QAAQ;AAChB,UAAM,QAAQ;AACd,gBAAY,QAAQ;AACpB,gBAAY,QAAQ;AAAA,EACtB;AAEA,SAAO;AAAA;AAAA,IAEL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,IAGA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,IAGA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ,CAAC;"}