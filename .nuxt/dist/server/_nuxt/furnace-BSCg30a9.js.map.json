{"file":"furnace-BSCg30a9.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_push","_parent","_unref","_ssrRenderList","_ssrInterpolate","_ssrRenderClass"],"sources":["../../../../stores/furnace.ts","../../../../pages/furnace.vue"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref } from 'vue'\r\n\r\nexport const useFurnaceStore = defineStore('furnace', () => {\r\n  // State\r\n  const furnaces = ref<any[]>([])\r\n  const recipes = ref<any[]>([])\r\n  const recentCrafting = ref<any[]>([])\r\n  const loading = ref(false)\r\n  const error = ref(null)\r\n\r\n  // Getters\r\n  const getRecipesByCategory = (category: string) => {\r\n    return recipes.value.filter(recipe => recipe.category === category)\r\n  }\r\n\r\n  const getRecipeById = (id: string) => {\r\n    return recipes.value.find(recipe => recipe.id === id)\r\n  }\r\n\r\n  const getFurnaceById = (id: string) => {\r\n    return furnaces.value.find(furnace => furnace.furnace.id === id)\r\n  }\r\n\r\n  const getCategoryIcon = (category: string) => {\r\n    const icons = {\r\n      alchemy: '🧪',\r\n      forging: '🔨',\r\n      crafting: '⚒️'\r\n    }\r\n    return icons[category] || '🔧'\r\n  }\r\n\r\n  const getCategoryName = (category: string) => {\r\n    const names = {\r\n      alchemy: 'Luyện Đan',\r\n      forging: 'Luyện Khí',\r\n      crafting: 'Chế Tạo'\r\n    }\r\n    return names[category] || category\r\n  }\r\n\r\n  const getSuccessRateColor = (rate: number) => {\r\n    if (rate >= 0.8) return '#10b981' // green\r\n    if (rate >= 0.6) return '#f59e0b' // yellow\r\n    if (rate >= 0.4) return '#f97316' // orange\r\n    return '#ef4444' // red\r\n  }\r\n\r\n  // Actions\r\n  const fetchFurnaceStatus = async (playerId: string) => {\r\n    try {\r\n      loading.value = true\r\n      error.value = null\r\n\r\n      const response: any = await $fetch(`/api/furnace/status?playerId=${playerId}`)\r\n      furnaces.value = response.data.furnaces\r\n      recipes.value = response.data.recipes\r\n      recentCrafting.value = response.data.recentCrafting\r\n    } catch (err: any) {\r\n      error.value = err.message\r\n      console.error('Error fetching furnace status:', err)\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n\r\n  const craftItem = async (playerId: string, recipeId: string, quantity: number = 1) => {\r\n    try {\r\n      loading.value = true\r\n      error.value = null\r\n\r\n      const response: any = await $fetch('/api/furnace/craft', {\r\n        method: 'POST',\r\n        body: {\r\n          playerId,\r\n          recipeId,\r\n          quantity\r\n        }\r\n      })\r\n\r\n      // Refresh furnace status after crafting\r\n      await fetchFurnaceStatus(playerId)\r\n\r\n      return response.data\r\n    } catch (err: any) {\r\n      error.value = err.message\r\n      console.error('Error crafting item:', err)\r\n      throw err\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n\r\n  const canCraft = (recipe: any, inventory: any[]) => {\r\n    if (!recipe) return false\r\n    \r\n    try {\r\n      const materials = JSON.parse(recipe.materials)\r\n      \r\n      for (const [materialName, requiredAmount] of Object.entries(materials)) {\r\n        const inventoryItem = inventory.find((item: any) => item.name === materialName)\r\n        if (!inventoryItem || inventoryItem.quantity < (requiredAmount as number)) {\r\n          return false\r\n        }\r\n      }\r\n      \r\n      return true\r\n    } catch (e) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  const getRequiredMaterials = (recipe: any) => {\r\n    if (!recipe) return []\r\n    \r\n    try {\r\n      const materials = JSON.parse(recipe.materials)\r\n      return Object.entries(materials).map(([name, amount]) => ({\r\n        name,\r\n        amount: Number(amount)\r\n      }))\r\n    } catch (e) {\r\n      return []\r\n    }\r\n  }\r\n\r\n  const getCraftResult = (recipe: any) => {\r\n    if (!recipe) return []\r\n    \r\n    try {\r\n      const result = JSON.parse(recipe.result)\r\n      return Object.entries(result).map(([name, amount]) => ({\r\n        name,\r\n        amount: Number(amount)\r\n      }))\r\n    } catch (e) {\r\n      return []\r\n    }\r\n  }\r\n\r\n  // Reset store\r\n  const reset = () => {\r\n    furnaces.value = []\r\n    recipes.value = []\r\n    recentCrafting.value = []\r\n    loading.value = false\r\n    error.value = null\r\n  }\r\n\r\n  return {\r\n    // State\r\n    furnaces,\r\n    recipes,\r\n    recentCrafting,\r\n    loading,\r\n    error,\r\n\r\n    // Getters\r\n    getRecipesByCategory,\r\n    getRecipeById,\r\n    getFurnaceById,\r\n    getCategoryIcon,\r\n    getCategoryName,\r\n    getSuccessRateColor,\r\n\r\n    // Actions\r\n    fetchFurnaceStatus,\r\n    craftItem,\r\n    canCraft,\r\n    getRequiredMaterials,\r\n    getCraftResult,\r\n    reset\r\n  }\r\n})\r\n","<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900\">\r\n    <!-- Header -->\r\n    <header class=\"bg-black/50 backdrop-blur-sm border-b border-purple-500/30\">\r\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div class=\"flex items-center justify-between h-16\">\r\n          <!-- Logo & Title -->\r\n          <div class=\"flex items-center space-x-4\">\r\n            <NuxtLink to=\"/\" class=\"text-2xl font-bold text-white\">\r\n              🔥 Đạo Lô\r\n            </NuxtLink>\r\n          </div>\r\n\r\n          <!-- Player Info -->\r\n          <div class=\"flex items-center space-x-6\">\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Tiên Ngọc</p>\r\n              <p class=\"text-lg font-semibold text-yellow-400\">{{ getResourceAmount('tien_ngoc') }}</p>\r\n            </div>\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Linh Thạch</p>\r\n              <p class=\"text-lg font-semibold text-blue-400\">{{ getResourceAmount('linh_thach') }}</p>\r\n            </div>\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Nguyên Thạch</p>\r\n              <p class=\"text-lg font-semibold text-green-400\">{{ getResourceAmount('nguyen_thach') }}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Actions -->\r\n          <div class=\"flex items-center space-x-2\">\r\n            <NuxtLink to=\"/\" class=\"game-button px-6 py-2 rounded-lg text-white font-semibold\">\r\n              🏠 Trang Chủ\r\n            </NuxtLink>\r\n            <button @click=\"handleLogout\" class=\"game-button px-6 py-2 rounded-lg text-white font-semibold\">\r\n              🚪 Đăng Xuất\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n\r\n    <main class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      <!-- Furnace Status -->\r\n      <div class=\"mb-8\">\r\n        <div class=\"game-card p-6 rounded-lg\">\r\n          <h2 class=\"text-2xl font-bold text-white mb-4\">Trạng Thái Lò Đạo</h2>\r\n          <div v-if=\"furnaces.length === 0\" class=\"text-center py-8\">\r\n            <div class=\"text-6xl mb-4\">🔥</div>\r\n            <div class=\"text-xl text-white mb-2\">Chưa có lò đạo</div>\r\n            <div class=\"text-game-text-secondary\">Hãy mua lò đạo tại cửa hàng!</div>\r\n          </div>\r\n          <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            <div\r\n              v-for=\"playerFurnace in furnaces\"\r\n              :key=\"playerFurnace.id\"\r\n              class=\"bg-gray-800/50 p-4 rounded-lg border border-gray-700\"\r\n            >\r\n              <div class=\"flex items-center justify-between mb-3\">\r\n                <h3 class=\"text-lg font-semibold text-white\">{{ playerFurnace.furnace.displayName }}</h3>\r\n                <span class=\"text-2xl\">{{ playerFurnace.furnace.icon }}</span>\r\n              </div>\r\n              <div class=\"space-y-2\">\r\n                <div class=\"flex justify-between\">\r\n                  <span class=\"text-sm text-game-text-secondary\">Cấp độ:</span>\r\n                  <span class=\"text-sm text-white\">{{ playerFurnace.level }}/{{ playerFurnace.furnace.maxLevel }}</span>\r\n                </div>\r\n                <div class=\"flex justify-between\">\r\n                  <span class=\"text-sm text-game-text-secondary\">Kinh nghiệm:</span>\r\n                  <span class=\"text-sm text-white\">{{ playerFurnace.experience }}</span>\r\n                </div>\r\n                <div class=\"flex justify-between\">\r\n                  <span class=\"text-sm text-game-text-secondary\">Hiệu suất:</span>\r\n                  <span class=\"text-sm text-green-400\">{{ (playerFurnace.furnace.efficiency * 100).toFixed(1) }}%</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Recipe Categories -->\r\n      <div class=\"mb-8\">\r\n        <h2 class=\"text-2xl font-bold text-white mb-4\">Công Thức Chế Tạo</h2>\r\n        <div class=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n          <button\r\n            v-for=\"category in recipeCategories\"\r\n            :key=\"category.name\"\r\n            @click=\"selectedCategory = category.name\"\r\n            :class=\"[\r\n              'p-4 rounded-lg border-2 transition-all duration-300',\r\n              selectedCategory === category.name\r\n                ? 'border-purple-500 bg-purple-500/20'\r\n                : 'border-gray-600 bg-gray-800/50 hover:border-purple-400'\r\n            ]\"\r\n          >\r\n            <div class=\"text-center\">\r\n              <div class=\"text-3xl mb-2\">{{ category.icon }}</div>\r\n              <div class=\"text-sm font-semibold text-white\">{{ category.displayName }}</div>\r\n              <div class=\"text-xs text-game-text-secondary\">{{ getRecipeCount(category.name) }} công thức</div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Loading -->\r\n      <div v-if=\"loading\" class=\"text-center py-8\">\r\n        <div class=\"text-white\">Đang tải công thức...</div>\r\n      </div>\r\n\r\n      <!-- Error -->\r\n      <div v-else-if=\"error\" class=\"text-center py-8\">\r\n        <div class=\"text-red-400\">Lỗi: {{ error }}</div>\r\n      </div>\r\n\r\n      <!-- Recipes Grid -->\r\n      <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n        <div\r\n          v-for=\"recipe in filteredRecipes\"\r\n          :key=\"recipe.id\"\r\n          class=\"bg-gray-800/50 p-6 rounded-lg border border-gray-700 hover:border-purple-500/50 transition-all duration-300\"\r\n        >\r\n          <div class=\"flex items-center justify-between mb-4\">\r\n            <div class=\"flex items-center space-x-3\">\r\n              <span class=\"text-2xl\">{{ getCategoryIcon(recipe.category) }}</span>\r\n              <div>\r\n                <h3 class=\"text-lg font-semibold text-white\">{{ recipe.displayName }}</h3>\r\n                <div class=\"text-xs text-game-text-secondary\">{{ getCategoryName(recipe.category) }}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <p class=\"text-sm text-game-text-secondary mb-4\">{{ recipe.description }}</p>\r\n\r\n          <!-- Required Materials -->\r\n          <div class=\"mb-4\">\r\n            <h4 class=\"text-sm font-semibold text-white mb-2\">Nguyên liệu cần:</h4>\r\n            <div class=\"space-y-1\">\r\n              <div\r\n                v-for=\"material in getRequiredMaterials(recipe)\"\r\n                :key=\"material.name\"\r\n                class=\"flex justify-between text-xs\"\r\n              >\r\n                <span class=\"text-game-text-secondary\">{{ material.name }}</span>\r\n                <span class=\"text-white\">{{ material.amount }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Craft Result -->\r\n          <div class=\"mb-4\">\r\n            <h4 class=\"text-sm font-semibold text-white mb-2\">Kết quả:</h4>\r\n            <div class=\"space-y-1\">\r\n              <div\r\n                v-for=\"result in getCraftResult(recipe)\"\r\n                :key=\"result.name\"\r\n                class=\"flex justify-between text-xs\"\r\n              >\r\n                <span class=\"text-game-text-secondary\">{{ result.name }}</span>\r\n                <span class=\"text-green-400\">{{ result.amount }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Recipe Info -->\r\n          <div class=\"mb-4 space-y-2\">\r\n            <div class=\"flex justify-between\">\r\n              <span class=\"text-xs text-game-text-secondary\">Cấp độ yêu cầu:</span>\r\n              <span class=\"text-xs text-white\">{{ recipe.level }}</span>\r\n            </div>\r\n            <div class=\"flex justify-between\">\r\n              <span class=\"text-xs text-game-text-secondary\">Tỷ lệ thành công:</span>\r\n              <span \r\n                class=\"text-xs font-semibold\"\r\n                :style=\"{ color: getSuccessRateColor(recipe.successRate) }\"\r\n              >\r\n                {{ (recipe.successRate * 100).toFixed(1) }}%\r\n              </span>\r\n            </div>\r\n            <div class=\"flex justify-between\">\r\n              <span class=\"text-xs text-game-text-secondary\">Kinh nghiệm:</span>\r\n              <span class=\"text-xs text-blue-400\">{{ recipe.experience }}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Craft Button -->\r\n          <button\r\n            @click=\"craftItem(recipe)\"\r\n            :disabled=\"!canCraftRecipe(recipe) || loading\"\r\n            class=\"w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed rounded text-sm font-semibold text-white transition-all duration-300\"\r\n          >\r\n            {{ canCraftRecipe(recipe) ? 'Chế Tạo' : 'Thiếu nguyên liệu' }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Recent Crafting History -->\r\n      <div v-if=\"recentCrafting.length > 0\" class=\"mt-12\">\r\n        <h2 class=\"text-2xl font-bold text-white mb-4\">Lịch Sử Chế Tạo</h2>\r\n        <div class=\"game-card p-6 rounded-lg\">\r\n          <div class=\"space-y-3\">\r\n            <div\r\n              v-for=\"craft in recentCrafting\"\r\n              :key=\"craft.id\"\r\n              class=\"flex items-center justify-between p-3 bg-gray-800/30 rounded-lg\"\r\n            >\r\n              <div class=\"flex items-center space-x-3\">\r\n                <span class=\"text-lg\">{{ getCategoryIcon(craft.recipe.category) }}</span>\r\n                <div>\r\n                  <div class=\"text-white font-semibold\">{{ craft.recipe.displayName }}</div>\r\n                  <div class=\"text-xs text-game-text-secondary\">\r\n                    {{ new Date(craft.createdAt).toLocaleString() }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"text-right\">\r\n                <div \r\n                  class=\"text-sm font-semibold\"\r\n                  :class=\"craft.success ? 'text-green-400' : 'text-red-400'\"\r\n                >\r\n                  {{ craft.success ? 'Thành công' : 'Thất bại' }}\r\n                </div>\r\n                <div class=\"text-xs text-game-text-secondary\">x{{ craft.quantity }}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// Stores\r\nconst authStore = useAuthStore()\r\nconst playerStore = usePlayerStore()\r\nconst shopStore = useShopStore()\r\nconst furnaceStore = useFurnaceStore()\r\n\r\n// Computed\r\nconst isAuthenticated = computed(() => authStore.isLoggedIn)\r\nconst player = computed(() => playerStore.player)\r\nconst resources = computed(() => playerStore.resources)\r\nconst furnaces = computed(() => furnaceStore.furnaces)\r\nconst recipes = computed(() => furnaceStore.recipes)\r\nconst recentCrafting = computed(() => furnaceStore.recentCrafting)\r\nconst loading = computed(() => furnaceStore.loading)\r\nconst error = computed(() => furnaceStore.error)\r\n\r\n// State\r\nconst selectedCategory = ref('all')\r\n\r\n// Recipe categories\r\nconst recipeCategories = [\r\n  { name: 'all', displayName: 'Tất Cả', icon: '🔧' },\r\n  { name: 'alchemy', displayName: 'Luyện Đan', icon: '🧪' },\r\n  { name: 'forging', displayName: 'Luyện Khí', icon: '🔨' },\r\n  { name: 'crafting', displayName: 'Chế Tạo', icon: '⚒️' }\r\n]\r\n\r\n// Computed\r\nconst filteredRecipes = computed(() => {\r\n  if (selectedCategory.value === 'all') {\r\n    return recipes.value\r\n  }\r\n  return recipes.value.filter(recipe => recipe.category === selectedCategory.value)\r\n})\r\n\r\n// Methods\r\nconst getResourceAmount = (resourceName) => {\r\n  const resource = playerStore.getResourceByName(resourceName)\r\n  return resource ? Number(resource.amount).toLocaleString() : '0'\r\n}\r\n\r\nconst getCategoryIcon = (category) => furnaceStore.getCategoryIcon(category)\r\nconst getCategoryName = (category) => furnaceStore.getCategoryName(category)\r\nconst getSuccessRateColor = (rate) => furnaceStore.getSuccessRateColor(rate)\r\nconst getRequiredMaterials = (recipe) => furnaceStore.getRequiredMaterials(recipe)\r\nconst getCraftResult = (recipe) => furnaceStore.getCraftResult(recipe)\r\n\r\nconst getRecipeCount = (category) => {\r\n  if (category === 'all') {\r\n    return recipes.value.length\r\n  }\r\n  return recipes.value.filter(recipe => recipe.category === category).length\r\n}\r\n\r\nconst canCraftRecipe = (recipe) => {\r\n  if (!player.value || player.value.level < recipe.level) return false\r\n  return furnaceStore.canCraft(recipe, shopStore.inventory)\r\n}\r\n\r\nconst craftItem = async (recipe) => {\r\n  if (!player.value?.id) return\r\n  \r\n  try {\r\n    const result = await furnaceStore.craftItem(player.value.id, recipe.id, 1)\r\n    \r\n    // Refresh inventory\r\n    await shopStore.fetchInventory(player.value.id)\r\n    \r\n    if (result.success) {\r\n      console.log(`Chế tạo thành công: ${recipe.displayName}`)\r\n    } else {\r\n      console.log(`Chế tạo thất bại: ${recipe.displayName}`)\r\n    }\r\n  } catch (err) {\r\n    console.error('Lỗi chế tạo:', err)\r\n  }\r\n}\r\n\r\nconst handleLogout = () => {\r\n  authStore.logout()\r\n  playerStore.reset()\r\n  shopStore.reset()\r\n  furnaceStore.reset()\r\n}\r\n\r\n// Initialize on mount\r\nonMounted(async () => {\r\n  authStore.initializeAuth()\r\n  \r\n  if (isAuthenticated.value && authStore.user?.player) {\r\n    await playerStore.initializePlayer(authStore.user.player.id)\r\n    await shopStore.fetchInventory(authStore.user.player.id)\r\n    await furnaceStore.fetchFurnaceStatus(authStore.user.player.id)\r\n  }\r\n})\r\n\r\n// Watch for authentication changes\r\nwatch(isAuthenticated, async (newValue) => {\r\n  if (newValue && authStore.user?.player) {\r\n    await playerStore.initializePlayer(authStore.user.player.id)\r\n    await shopStore.fetchInventory(authStore.user.player.id)\r\n    await furnaceStore.fetchFurnaceStatus(authStore.user.player.id)\r\n  } else {\r\n    furnaceStore.reset()\r\n  }\r\n})\r\n</script>\r\n"],"version":3}