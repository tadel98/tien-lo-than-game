{"file":"shop-DGXaTHrO.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_push","_parent","_ssrRenderList","_unref","_ssrInterpolate","_ssrRenderAttr"],"sources":["../../../../pages/shop.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900\">\r\n    <!-- Header -->\r\n    <header class=\"bg-black/50 backdrop-blur-sm border-b border-purple-500/30\">\r\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div class=\"flex items-center justify-between h-16\">\r\n          <!-- Logo & Title -->\r\n          <div class=\"flex items-center space-x-4\">\r\n            <NuxtLink to=\"/\" class=\"text-2xl font-bold text-white\">\r\n              üè™ C·ª≠a H√†ng\r\n            </NuxtLink>\r\n          </div>\r\n\r\n          <!-- Player Info -->\r\n          <div class=\"flex items-center space-x-6\">\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Ti√™n Ng·ªçc</p>\r\n              <p class=\"text-lg font-semibold text-yellow-400\">{{ getResourceAmount('tien_ngoc') }}</p>\r\n            </div>\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Linh Th·∫°ch</p>\r\n              <p class=\"text-lg font-semibold text-blue-400\">{{ getResourceAmount('linh_thach') }}</p>\r\n            </div>\r\n            <div class=\"text-center\">\r\n              <p class=\"text-sm text-game-text-secondary\">Nguy√™n Th·∫°ch</p>\r\n              <p class=\"text-lg font-semibold text-green-400\">{{ getResourceAmount('nguyen_thach') }}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Actions -->\r\n          <div class=\"flex items-center space-x-2\">\r\n            <NuxtLink to=\"/\" class=\"game-button px-6 py-2 rounded-lg text-white font-semibold\">\r\n              üè† Trang Ch·ªß\r\n            </NuxtLink>\r\n            <button @click=\"handleLogout\" class=\"game-button px-6 py-2 rounded-lg text-white font-semibold\">\r\n              üö™ ƒêƒÉng Xu·∫•t\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </header>\r\n\r\n    <main class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      <!-- Shop Categories -->\r\n      <div class=\"mb-8\">\r\n        <h2 class=\"text-2xl font-bold text-white mb-4\">Danh M·ª•c C·ª≠a H√†ng</h2>\r\n        <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n          <button\r\n            v-for=\"category in shopCategories\"\r\n            :key=\"category.name\"\r\n            @click=\"selectedCategory = category.name\"\r\n            :class=\"[\r\n              'p-4 rounded-lg border-2 transition-all duration-300',\r\n              selectedCategory === category.name\r\n                ? 'border-purple-500 bg-purple-500/20'\r\n                : 'border-gray-600 bg-gray-800/50 hover:border-purple-400'\r\n            ]\"\r\n          >\r\n            <div class=\"text-center\">\r\n              <div class=\"text-3xl mb-2\">{{ category.icon }}</div>\r\n              <div class=\"text-sm font-semibold text-white\">{{ category.displayName }}</div>\r\n              <div class=\"text-xs text-game-text-secondary\">{{ category.description }}</div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Shop List -->\r\n      <div v-if=\"loading\" class=\"text-center py-8\">\r\n        <div class=\"text-white\">ƒêang t·∫£i c·ª≠a h√†ng...</div>\r\n      </div>\r\n\r\n      <div v-else-if=\"error\" class=\"text-center py-8\">\r\n        <div class=\"text-red-400\">L·ªói: {{ error }}</div>\r\n      </div>\r\n\r\n      <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n        <div\r\n          v-for=\"shop in filteredShops\"\r\n          :key=\"shop.id\"\r\n          class=\"game-card p-6 rounded-lg\"\r\n        >\r\n          <div class=\"flex items-center justify-between mb-4\">\r\n            <h3 class=\"text-xl font-bold text-white\">{{ shop.displayName }}</h3>\r\n            <span class=\"text-2xl\">{{ shop.icon }}</span>\r\n          </div>\r\n          \r\n          <p class=\"text-game-text-secondary mb-4\">{{ shop.description }}</p>\r\n          \r\n          <div class=\"mb-4\">\r\n            <div class=\"text-sm text-game-text-secondary mb-2\">S·ªë l∆∞·ª£ng item: {{ shop.items.length }}</div>\r\n            <div class=\"text-sm text-game-text-secondary\">Lo·∫°i: {{ getCategoryDisplayName(shop.category) }}</div>\r\n          </div>\r\n\r\n          <button\r\n            @click=\"enterShop(shop)\"\r\n            class=\"w-full game-button py-2 px-4 rounded-lg text-white font-semibold\"\r\n          >\r\n            V√†o C·ª≠a H√†ng\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Shop Items Modal -->\r\n      <div v-if=\"currentShop\" class=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\r\n        <div class=\"bg-gray-900 rounded-lg max-w-4xl w-full max-h-[80vh] overflow-hidden\">\r\n          <!-- Modal Header -->\r\n          <div class=\"flex items-center justify-between p-6 border-b border-gray-700\">\r\n            <div class=\"flex items-center space-x-3\">\r\n              <span class=\"text-2xl\">{{ currentShop.icon }}</span>\r\n              <h2 class=\"text-2xl font-bold text-white\">{{ currentShop.displayName }}</h2>\r\n            </div>\r\n            <button @click=\"currentShop = null\" class=\"text-gray-400 hover:text-white text-2xl\">\r\n              ‚úï\r\n            </button>\r\n          </div>\r\n\r\n          <!-- Modal Content -->\r\n          <div class=\"p-6 overflow-y-auto max-h-[60vh]\">\r\n            <div v-if=\"currentShop.items.length === 0\" class=\"text-center py-8\">\r\n              <div class=\"text-game-text-secondary\">C·ª≠a h√†ng n√†y ch∆∞a c√≥ item n√†o</div>\r\n            </div>\r\n\r\n            <div v-else class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div\r\n                v-for=\"item in currentShop.items\"\r\n                :key=\"item.id\"\r\n                class=\"bg-gray-800/50 p-4 rounded-lg border border-gray-700\"\r\n              >\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                  <div class=\"flex items-center space-x-3\">\r\n                    <span class=\"text-2xl\">{{ getItemTypeIcon(item.itemType) }}</span>\r\n                    <div>\r\n                      <h4 class=\"text-lg font-semibold text-white\">{{ item.displayName }}</h4>\r\n                      <div class=\"flex items-center space-x-2\">\r\n                        <span \r\n                          class=\"px-2 py-1 rounded text-xs font-semibold\"\r\n                          :style=\"{ \r\n                            backgroundColor: getRarityColor(item.rarity) + '20',\r\n                            color: getRarityColor(item.rarity)\r\n                          }\"\r\n                        >\r\n                          {{ item.rarity.toUpperCase() }}\r\n                        </span>\r\n                        <span class=\"text-xs text-game-text-secondary\">C·∫•p {{ item.level }}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <p class=\"text-sm text-game-text-secondary mb-3\">{{ item.description }}</p>\r\n\r\n                <div class=\"flex items-center justify-between\">\r\n                  <div class=\"flex items-center space-x-2\">\r\n                    <span class=\"text-yellow-400 font-semibold\">{{ item.price.toLocaleString() }}</span>\r\n                    <span class=\"text-sm text-game-text-secondary\">{{ getCurrencyName(item.currency) }}</span>\r\n                  </div>\r\n                  \r\n                  <div class=\"flex items-center space-x-2\">\r\n                    <input\r\n                      v-model.number=\"purchaseQuantities[item.id]\"\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      :max=\"item.stock === -1 ? 999 : item.stock\"\r\n                      class=\"w-16 px-2 py-1 bg-gray-700 text-white rounded text-sm\"\r\n                    />\r\n                    <button\r\n                      @click=\"purchaseItem(item)\"\r\n                      :disabled=\"loading || !canPurchase(item)\"\r\n                      class=\"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed rounded text-sm font-semibold text-white\"\r\n                    >\r\n                      Mua\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div v-if=\"item.stock !== -1\" class=\"text-xs text-game-text-secondary mt-2\">\r\n                  C√≤n l·∫°i: {{ item.stock }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// Stores\r\nconst authStore = useAuthStore()\r\nconst playerStore = usePlayerStore()\r\nconst shopStore = useShopStore()\r\n\r\n// Computed\r\nconst isAuthenticated = computed(() => authStore.isLoggedIn)\r\nconst player = computed(() => playerStore.player)\r\nconst resources = computed(() => playerStore.resources)\r\nconst shops = computed(() => shopStore.shops)\r\nconst loading = computed(() => shopStore.loading)\r\nconst error = computed(() => shopStore.error)\r\nconst currentShop = computed(() => shopStore.currentShop)\r\n\r\n// State\r\nconst selectedCategory = ref('all')\r\nconst purchaseQuantities = ref({})\r\n\r\n// Shop categories\r\nconst shopCategories = [\r\n  { name: 'all', displayName: 'T·∫•t C·∫£', icon: 'üè™', description: 'Xem t·∫•t c·∫£ c·ª≠a h√†ng' },\r\n  { name: 'equipment', displayName: 'Trang B·ªã', icon: '‚öîÔ∏è', description: 'V≈© kh√≠ v√† √°o gi√°p' },\r\n  { name: 'consumables', displayName: 'Ti√™u Hao', icon: 'üß™', description: 'Thu·ªëc v√† v·∫≠t ph·∫©m' },\r\n  { name: 'materials', displayName: 'Nguy√™n Li·ªáu', icon: 'üíé', description: 'V·∫≠t li·ªáu ch·∫ø t·∫°o' }\r\n]\r\n\r\n// Computed\r\nconst filteredShops = computed(() => {\r\n  if (selectedCategory.value === 'all') {\r\n    return shops.value\r\n  }\r\n  return shops.value.filter(shop => shop.category === selectedCategory.value)\r\n})\r\n\r\n// Methods\r\nconst getResourceAmount = (resourceName) => {\r\n  const resource = playerStore.getResourceByName(resourceName)\r\n  return resource ? Number(resource.amount).toLocaleString() : '0'\r\n}\r\n\r\nconst getCategoryDisplayName = (category) => {\r\n  const cat = shopCategories.find(c => c.name === category)\r\n  return cat ? cat.displayName : category\r\n}\r\n\r\nconst getCurrencyName = (currency) => {\r\n  const currencies = {\r\n    tien_ngoc: 'Ti√™n Ng·ªçc',\r\n    linh_thach: 'Linh Th·∫°ch',\r\n    nguyen_thach: 'Nguy√™n Th·∫°ch'\r\n  }\r\n  return currencies[currency] || currency\r\n}\r\n\r\nconst getRarityColor = (rarity) => shopStore.getRarityColor(rarity)\r\nconst getItemTypeIcon = (itemType) => shopStore.getItemTypeIcon(itemType)\r\n\r\nconst enterShop = (shop) => {\r\n  shopStore.setCurrentShop(shop)\r\n  // Initialize purchase quantities\r\n  shop.items.forEach(item => {\r\n    purchaseQuantities.value[item.id] = 1\r\n  })\r\n}\r\n\r\nconst canPurchase = (item) => {\r\n  const quantity = purchaseQuantities.value[item.id] || 1\r\n  const totalCost = item.price * quantity\r\n  \r\n  const currencyResource = playerStore.getResourceByName(item.currency)\r\n  if (!currencyResource) return false\r\n  \r\n  return Number(currencyResource.amount) >= totalCost && \r\n         (item.stock === -1 || item.stock >= quantity) &&\r\n         player.value.level >= item.level\r\n}\r\n\r\nconst purchaseItem = async (item) => {\r\n  if (!player.value?.id) return\r\n  \r\n  const quantity = purchaseQuantities.value[item.id] || 1\r\n  \r\n  try {\r\n    await shopStore.purchaseItem(player.value.id, currentShop.value.id, item.id, quantity)\r\n    \r\n    // Refresh player resources\r\n    await playerStore.fetchResources(player.value.id)\r\n    \r\n    console.log(`Mua th√†nh c√¥ng ${item.displayName} x${quantity}`)\r\n  } catch (err) {\r\n    console.error('L·ªói mua h√†ng:', err)\r\n  }\r\n}\r\n\r\nconst handleLogout = () => {\r\n  authStore.logout()\r\n  playerStore.reset()\r\n  shopStore.reset()\r\n}\r\n\r\n// Initialize on mount\r\nonMounted(async () => {\r\n  authStore.initializeAuth()\r\n  \r\n  if (isAuthenticated.value && authStore.user?.player) {\r\n    await playerStore.initializePlayer(authStore.user.player.id)\r\n    await shopStore.fetchShops()\r\n  }\r\n})\r\n\r\n// Watch for authentication changes\r\nwatch(isAuthenticated, async (newValue) => {\r\n  if (newValue && authStore.user?.player) {\r\n    await playerStore.initializePlayer(authStore.user.player.id)\r\n    await shopStore.fetchShops()\r\n  } else {\r\n    shopStore.reset()\r\n  }\r\n})\r\n</script>\r\n"],"version":3}